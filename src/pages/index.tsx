import { AdminLayout } from '@layout'
import { AiFillCaretDown } from "react-icons/ai";
import React, { useEffect, useState, useRef } from 'react'
import TableComponent from 'src/components/Table/Table'
import { Box, Flex, Input, Menu, MenuButton, MenuItem, MenuList, Text, Button, Card, CardHeader, CardBody, useToast, IconButton, Tooltip } from '@chakra-ui/react'
import { Duration } from 'enums';
import { resolveDuration } from 'utils';
import { TbDownload } from 'react-icons/tb';
import * as PapaParse from 'papaparse';

export default function Home() {
  const [searchQuery, setSearchQuery] = useState<string>('');

  const toast = useToast();

  const [shippingList, setShippingList] = useState<any[]>([]);
  const [duration, setDuration] = useState<Duration>(Duration.LAST_WEEK);

  const { from, to } = resolveDuration(duration, '', '');
  const [fromDate, setFromDate] = useState<string>(from);
  const [toDate, setToDate] = useState<string>(to);
  const csvLink = useRef()

  const API_HOST = "https://unilog.unicommerce.com" // "https://unilog.unicommerce.com", "http://localhost:8000"

  const parseDate = (oldDate: string): string => !oldDate ? "-" : (new Date(oldDate).toLocaleDateString("en-IN", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric"
  }));

  async function getDownloadableData(): Promise<any> {
    // const res = await fetch(API_HOST + "/shipper/api/tracking-list", {
    //   method: "POST",
    //   headers: {
    //     'APP-KEY': '#$%^SK&SNLSH*^%SF'
    //   },
    //   body: JSON.stringify({ "search_text": searchQuery, "from": fromDate, "to": toDate })
    // });

    // if (!res.ok) throw new Error(res.statusText);

    // return await res.json();

    const rows = new Promise(function(res, rej) {
      res([
        {
          "tracking_number": "53444266761",
          "shipping_source_code": "BLUEDART",
          "order_number": "4723475054771",
          "shipping_package_code": "SP-CH-FY23-04714",
          "facility_code": "INV",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-02T10:20:05",
          "dispatch_datetime": "2023-02-03T18:15:10",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Kaushal Rautela",
          "customer_phone": "63961 15911",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444548135",
          "shipping_source_code": "BLUEDART",
          "order_number": "4727572398259",
          "shipping_package_code": "SP-CH-FY23-04725",
          "facility_code": "INV",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T05:20:04",
          "dispatch_datetime": "2023-02-07T16:53:34",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "VIPIN  BHATI",
          "customer_phone": "91676 63001",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444272814",
          "shipping_source_code": "BLUEDART",
          "order_number": "4724869497011",
          "shipping_package_code": "SP-DEL-FY23-13207",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T09:00:04",
          "dispatch_datetime": "2023-02-03T17:30:15",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Saji Ravindran",
          "customer_phone": "94961 65081",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444548172",
          "shipping_source_code": "BLUEDART",
          "order_number": "4727095296179",
          "shipping_package_code": "SP-DEL-FY23-13227",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T22:10:04",
          "dispatch_datetime": "2023-02-07T15:52:03",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Sarthak Satyajeet",
          "customer_phone": "7873924007",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444548662",
          "shipping_source_code": "BLUEDART",
          "order_number": "4727444406451",
          "shipping_package_code": "SP-DEL-FY23-13228",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T03:10:04",
          "dispatch_datetime": "2023-02-07T15:52:03",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Shashikiran Dayalan",
          "customer_phone": "90355 70879",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444548835",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726510256307",
          "shipping_package_code": "SP-DEL-FY23-13225",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T11:20:04",
          "dispatch_datetime": "2023-02-07T15:52:04",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "GURUKRIPA CAREER EDUCATION PVT LTD ",
          "customer_phone": " 78913 09641",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444554881",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729352028339",
          "shipping_package_code": "SP-DEL-FY23-13231",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T17:50:04",
          "dispatch_datetime": "2023-02-07T15:52:04",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "ABHINAV M",
          "customer_phone": "9787377269",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444554472",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729179406515",
          "shipping_package_code": "SP-DEL-FY23-13230",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T13:50:04",
          "dispatch_datetime": "2023-02-07T15:52:06",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Geetha M",
          "customer_phone": "79950 96666",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444567643",
          "shipping_source_code": "BLUEDART",
          "order_number": "4722406850739",
          "shipping_package_code": "SP-DEL-FY23-13235",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T19:30:04",
          "dispatch_datetime": "2023-02-07T15:52:06",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "HARA PRASAD PAL",
          "customer_phone": "99713 99158",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444613316",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729194807475",
          "shipping_package_code": "SP-DEL-FY23-13238",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T14:10:05",
          "dispatch_datetime": "2023-02-07T17:41:00",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Abhinav Meesala",
          "customer_phone": "9177297056",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444614974",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729361498291",
          "shipping_package_code": "SP-DEL-FY23-13240",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T18:00:04",
          "dispatch_datetime": "2023-02-07T17:41:01",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Naren Garapati",
          "customer_phone": "75692 44875",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444617715",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729326141619",
          "shipping_package_code": "SP-DEL-FY23-13239",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T17:20:07",
          "dispatch_datetime": "2023-02-07T17:41:02",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Gaurav Khude",
          "customer_phone": "90494 67167",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444620025",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729638256819",
          "shipping_package_code": "SP-DEL-FY23-13243",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T22:50:04",
          "dispatch_datetime": "2023-02-07T17:41:03",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Utsav  Guhathakurta",
          "customer_phone": "9051152417",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444616352",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729622003891",
          "shipping_package_code": "SP-DEL-FY23-13242",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T22:30:04",
          "dispatch_datetime": "2023-02-07T17:41:02",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Blessy Varghese",
          "customer_phone": "70625 82135",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444273525",
          "shipping_source_code": "BLUEDART",
          "order_number": "4723620348083",
          "shipping_package_code": "SP-DEL-FY23-13205",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-02T13:40:04",
          "dispatch_datetime": "2023-02-03T17:30:15",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Mukund  Rao",
          "customer_phone": "63851 33825",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443351246",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726661972147",
          "shipping_package_code": "SP-DEL-FY23-13226",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T15:10:04",
          "dispatch_datetime": "2023-02-07T15:51:27",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Dhruv Mark Collins",
          "customer_phone": "80744 01294",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20442868084",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726755328179",
          "shipping_package_code": "SP-DEL-FY23-13216",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T16:50:05",
          "dispatch_datetime": "2023-02-06T15:56:46",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Akash Mehar",
          "customer_phone": "83191 43294",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443459481",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729026740403",
          "shipping_package_code": "SP-DEL-FY23-13233",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T10:10:04",
          "dispatch_datetime": "2023-02-07T15:51:30",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Ajith Krishnamoorthy",
          "customer_phone": "9003069190",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443458346",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729006260403",
          "shipping_package_code": "SP-DEL-FY23-13232",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T09:40:04",
          "dispatch_datetime": "2023-02-07T15:51:29",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Hubert Tassin",
          "customer_phone": "89405 60258",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443460645",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729485492403",
          "shipping_package_code": "SP-DEL-FY23-13234",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T20:30:05",
          "dispatch_datetime": "2023-02-07T15:51:29",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Sanam P",
          "customer_phone": "80978 45413",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443389492",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729156370611",
          "shipping_package_code": "SP-DEL-FY23-13229",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T13:10:06",
          "dispatch_datetime": "2023-02-07T15:51:28",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Deep Gujarathi",
          "customer_phone": "7000130179",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443015132",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726555214003",
          "shipping_package_code": "SP-DEL-FY23-13217",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-04T12:30:05",
          "dispatch_datetime": "2023-02-06T15:56:48",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": "2023-02-08T11:32:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "ABHINAV M",
          "customer_phone": "9787377269",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444343595",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725191540915",
          "shipping_package_code": "SP-CH-FY23-04721",
          "facility_code": "INV",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T16:10:04",
          "dispatch_datetime": "2023-02-04T17:52:53",
          "expected_delivered_datetime": "2023-02-14T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Nandini Velho",
          "customer_phone": "09422457352",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120244138",
          "shipping_source_code": "ECOM",
          "order_number": "4728033181875",
          "shipping_package_code": "SP-BHI-FY23-178798",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T16:50:04",
          "dispatch_datetime": "2023-02-06T15:02:58",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Gannon Mossang",
          "customer_phone": "89746 55610",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3119939257",
          "shipping_source_code": "ECOM",
          "order_number": "4727871373491",
          "shipping_package_code": "SP-BHI-FY23-178777",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T12:50:04",
          "dispatch_datetime": "2023-02-06T15:03:01",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "mahikanshu  mehta",
          "customer_phone": "99996 22392",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120233178",
          "shipping_source_code": "ECOM",
          "order_number": "4728200364211",
          "shipping_package_code": "SP-BHI-FY23-178810",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T20:10:04",
          "dispatch_datetime": "2023-02-06T15:02:57",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Reshmasree  Lankalapalli ",
          "customer_phone": "96425 69636",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443544063",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721812996275",
          "shipping_package_code": "SP-DEL-FY23-13236",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T11:20:04",
          "dispatch_datetime": "2023-02-07T15:51:30",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Roshan George",
          "customer_phone": "99457 24372",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120244011",
          "shipping_source_code": "ECOM",
          "order_number": "4728180572339",
          "shipping_package_code": "SP-BHI-FY23-178808",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T19:50:04",
          "dispatch_datetime": "2023-02-06T15:02:58",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "TANMOY DAS",
          "customer_phone": "9933558264",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120232943",
          "shipping_source_code": "ECOM",
          "order_number": "4728798871731",
          "shipping_package_code": "SP-BHI-FY23-178832",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T04:40:04",
          "dispatch_datetime": "2023-02-06T15:02:57",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Kalicharan  Shaw ",
          "customer_phone": "9674059256",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444381200",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726698574003",
          "shipping_package_code": "SP-BHI-FY23-178715",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T15:50:04",
          "dispatch_datetime": "2023-02-05T15:50:40",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "SUBHANAN MAITY",
          "customer_phone": "76022 05060",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444381734",
          "shipping_source_code": "BLUEDART",
          "order_number": "4708318118067-SRS10704",
          "shipping_package_code": "SP-BHI-FY23-178716",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T16:08:49",
          "dispatch_datetime": "2023-02-05T15:56:02",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "dixit pahwa",
          "customer_phone": "9815396765",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444473143",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726627401907",
          "shipping_package_code": "SP-BHI-FY23-178863",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T14:20:04",
          "dispatch_datetime": "2023-02-07T15:09:00",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Abhishek Tripathi",
          "customer_phone": " 91300 81376",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444360174",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726584541363",
          "shipping_package_code": "SP-BHI-FY23-178698",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T13:10:05",
          "dispatch_datetime": "2023-02-05T15:50:40",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Muthu Kumar P ",
          "customer_phone": "8608845557",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444433475",
          "shipping_source_code": "BLUEDART",
          "order_number": "4728340480179",
          "shipping_package_code": "SP-BHI-FY23-178818",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T22:20:04",
          "dispatch_datetime": "2023-02-06T15:08:20",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Alagammai Kannappan",
          "customer_phone": "97910 28310",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444430270",
          "shipping_source_code": "BLUEDART",
          "order_number": "4728125456563",
          "shipping_package_code": "SP-BHI-FY23-178803",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T18:40:04",
          "dispatch_datetime": "2023-02-06T15:08:20",
          "expected_delivered_datetime": "2023-02-09T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Sri  Vishal",
          "customer_phone": "93441 30327",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444550596",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726455926963",
          "shipping_package_code": "SP-BHI-FY23-178908",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T10:10:04",
          "dispatch_datetime": "2023-02-07T15:08:54",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Shameem Rahman",
          "customer_phone": "94875 35448",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444404974",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726622355635",
          "shipping_package_code": "SP-BHI-FY23-178706",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T14:10:04",
          "dispatch_datetime": "2023-02-05T15:53:39",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Reshma Krishnan",
          "customer_phone": "07025427084",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444552534",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729759400115",
          "shipping_package_code": "SP-BHI-FY23-178931",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-07T00:30:05",
          "dispatch_datetime": "2023-02-07T15:08:55",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Poojitha K",
          "customer_phone": "99405 19551",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444560190",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729350881459",
          "shipping_package_code": "SP-BHI-FY23-178892",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T17:40:04",
          "dispatch_datetime": "2023-02-07T15:08:55",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "vinayak pawar",
          "customer_phone": "81086 71678",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444561575",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721807687859",
          "shipping_package_code": "SP-BHI-FY23-178955",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T11:10:04",
          "dispatch_datetime": "2023-02-07T15:08:56",
          "expected_delivered_datetime": "2023-02-15T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Obed Khangshou ",
          "customer_phone": "8837467828",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444583555",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729355600051",
          "shipping_package_code": "SP-BHI-FY23-178895",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T17:50:04",
          "dispatch_datetime": "2023-02-07T15:08:56",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Prashanth R",
          "customer_phone": "99406 93454",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444470306",
          "shipping_source_code": "BLUEDART",
          "order_number": "4728042225843",
          "shipping_package_code": "SP-BHI-FY23-178856",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T17:00:03",
          "dispatch_datetime": "2023-02-07T15:08:58",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 6,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Anish Rao",
          "customer_phone": "98190 80019",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444472745",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729179275443",
          "shipping_package_code": "SP-BHI-FY23-178866",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T13:50:05",
          "dispatch_datetime": "2023-02-07T15:08:59",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Kartik Sompura",
          "customer_phone": "88066 18757",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444330752",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725597667507",
          "shipping_package_code": "SP-BHI-FY23-178664",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T22:40:04",
          "dispatch_datetime": "2023-02-04T15:27:12",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Hirak Sharma",
          "customer_phone": "7002874487",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444549933",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729765757107",
          "shipping_package_code": "SP-BHI-FY23-178934",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-07T00:40:04",
          "dispatch_datetime": "2023-02-07T15:08:53",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Jitender Bedwal",
          "customer_phone": "96673 04694",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444258313",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725014888627",
          "shipping_package_code": "SP-BHI-FY23-178627",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T12:20:05",
          "dispatch_datetime": "2023-02-04T15:27:17",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Kunal mandal ",
          "customer_phone": " 89620 23903",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444256353",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725014888627",
          "shipping_package_code": "SP-BHI-FY23-178626",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T12:20:05",
          "dispatch_datetime": "2023-02-04T15:27:16",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Kunal mandal ",
          "customer_phone": " 89620 23903",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444164454",
          "shipping_source_code": "BLUEDART",
          "order_number": "4722175443123",
          "shipping_package_code": "SP-BHI-FY23-178528",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-01T16:40:05",
          "dispatch_datetime": "2023-02-03T15:27:36",
          "expected_delivered_datetime": "2023-02-06T18:00:00",
          "delivered_datetime": "2023-02-07T20:10:00",
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Roshni  Saraf",
          "customer_phone": "80779 17679",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53443984230",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721813127347",
          "shipping_package_code": "SP-BHI-FY23-178356",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-01T11:20:04",
          "dispatch_datetime": "2023-02-01T15:33:28",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": "2023-02-07T18:49:00",
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Prerana Pandey",
          "customer_phone": "79065 69661",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444322282",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725819572403",
          "shipping_package_code": "SP-BHI-FY23-178683",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T00:00:05",
          "dispatch_datetime": "2023-02-04T15:27:09",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Anchal Chaturvedi",
          "customer_phone": "074040 37354",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3119766561",
          "shipping_source_code": "ECOM",
          "order_number": "4726672064691",
          "shipping_package_code": "SP-BHI-FY23-178714",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "Returned",
          "order_datetime": "2023-02-04T15:20:05",
          "dispatch_datetime": "2023-02-05T13:40:50",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Sandesh Rane",
          "customer_phone": "91309 51487",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120245072",
          "shipping_source_code": "ECOM",
          "order_number": "4728110284979",
          "shipping_package_code": "SP-BHI-FY23-178801",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T18:20:04",
          "dispatch_datetime": "2023-02-06T15:03:00",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Aryan Priyadarshi",
          "customer_phone": "7461004199",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3119755684",
          "shipping_source_code": "ECOM",
          "order_number": "4726566027443",
          "shipping_package_code": "SP-BHI-FY23-178695",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T12:40:04",
          "dispatch_datetime": "2023-02-05T13:40:50",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Manish Kumar",
          "customer_phone": "98967 30432",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3119688226",
          "shipping_source_code": "ECOM",
          "order_number": "4726593487027",
          "shipping_package_code": "SP-BHI-FY23-178702",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T13:30:04",
          "dispatch_datetime": "2023-02-05T13:40:48",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 5,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Ajay Thakur ",
          "customer_phone": "82192 11566",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443004105",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726627401907",
          "shipping_package_code": "SP-DEL-FY23-13218",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-04T14:20:04",
          "dispatch_datetime": "2023-02-06T15:56:47",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": "2023-02-07T16:44:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Abhishek Tripathi",
          "customer_phone": " 91300 81376",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120762756",
          "shipping_source_code": "ECOM",
          "order_number": "4729375981747",
          "shipping_package_code": "SP-BHI-FY23-178898",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T18:20:05",
          "dispatch_datetime": "2023-02-07T16:21:21",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Garima  Singh ",
          "customer_phone": "78951 68357",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120378436",
          "shipping_source_code": "ECOM",
          "order_number": "4729205555379",
          "shipping_package_code": "SP-BHI-FY23-178871",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T14:30:05",
          "dispatch_datetime": "2023-02-07T16:21:30",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Sitaram Pandey",
          "customer_phone": "94539 01961",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120668341",
          "shipping_source_code": "ECOM",
          "order_number": "4727095296179",
          "shipping_package_code": "SP-BHI-FY23-178882",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T22:10:04",
          "dispatch_datetime": "2023-02-07T16:21:20",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Sarthak Satyajeet",
          "customer_phone": "7873924007",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120350584",
          "shipping_source_code": "ECOM",
          "order_number": "4729193431219",
          "shipping_package_code": "SP-BHI-FY23-178867",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T14:00:05",
          "dispatch_datetime": "2023-02-07T16:21:29",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Robin Rawat",
          "customer_phone": "070534 50593",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120777291",
          "shipping_source_code": "ECOM",
          "order_number": "4730335723699",
          "shipping_package_code": "SP-BHI-FY23-178948",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-07T10:50:04",
          "dispatch_datetime": "2023-02-07T16:21:23",
          "expected_delivered_datetime": "2023-02-14T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Aman toppo",
          "customer_phone": "79034 92719",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120766151",
          "shipping_source_code": "ECOM",
          "order_number": "4729315655859",
          "shipping_package_code": "SP-BHI-FY23-178887",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T17:10:04",
          "dispatch_datetime": "2023-02-07T16:21:22",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Abhishek  Sahu",
          "customer_phone": " 62639 22658",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120765825",
          "shipping_source_code": "ECOM",
          "order_number": "4729310347443",
          "shipping_package_code": "SP-BHI-FY23-178886",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T17:00:04",
          "dispatch_datetime": "2023-02-07T16:21:21",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "SATYARANJAN MAJHI ",
          "customer_phone": " 63726 89362",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120762025",
          "shipping_source_code": "ECOM",
          "order_number": "4729494110387",
          "shipping_package_code": "SP-BHI-FY23-178914",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T20:40:05",
          "dispatch_datetime": "2023-02-07T16:21:20",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Cheng Rims",
          "customer_phone": "06000047726",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120345404",
          "shipping_source_code": "ECOM",
          "order_number": "4729207226547",
          "shipping_package_code": "SP-BHI-FY23-178872",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T14:30:04",
          "dispatch_datetime": "2023-02-07T16:21:28",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Chandramani  Kushwaha ",
          "customer_phone": "9630654545",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120375825",
          "shipping_source_code": "ECOM",
          "order_number": "4726541811891",
          "shipping_package_code": "SP-BHI-FY23-178879",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T14:22:56",
          "dispatch_datetime": "2023-02-07T16:21:30",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 5,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Alpesh Kabra ",
          "customer_phone": "88245 28385",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444249412",
          "shipping_source_code": "BLUEDART",
          "order_number": "4724875165875",
          "shipping_package_code": "SP-BHI-FY23-178588",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T09:10:04",
          "dispatch_datetime": "2023-02-03T15:27:30",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "DEVASHISH PRASAD",
          "customer_phone": "95644 11000",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443009230",
          "shipping_source_code": "BLUEDART",
          "order_number": "4727764320435",
          "shipping_package_code": "SP-DEL-FY23-13221",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-05T10:20:03",
          "dispatch_datetime": "2023-02-06T15:56:46",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": "2023-02-07T15:35:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Bishal Saha",
          "customer_phone": "8617492029",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20442443501",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725538783411",
          "shipping_package_code": "SP-DEL-FY23-13211",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-03T21:50:04",
          "dispatch_datetime": "2023-02-04T15:56:49",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": "2023-02-07T15:16:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Simranjit  Singh ",
          "customer_phone": "88727 27289",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444584012",
          "shipping_source_code": "BLUEDART",
          "order_number": "4729762611379",
          "shipping_package_code": "SP-BHI-FY23-178932",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-07T00:30:04",
          "dispatch_datetime": "2023-02-07T15:08:57",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Pritom Das",
          "customer_phone": "88204 38916",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443012763",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726661415091",
          "shipping_package_code": "SP-DEL-FY23-13219",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-04T15:00:04",
          "dispatch_datetime": "2023-02-06T15:56:47",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": "2023-02-07T14:28:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Vikraant Koushika Pai",
          "customer_phone": "098211 43211",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443005575",
          "shipping_source_code": "BLUEDART",
          "order_number": "4728430887091",
          "shipping_package_code": "SP-DEL-FY23-13223",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-05T23:30:04",
          "dispatch_datetime": "2023-02-06T15:56:45",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": "2023-02-07T13:13:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Sivaramakrishnan KN",
          "customer_phone": "9003021055",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444321324",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725819572403",
          "shipping_package_code": "SP-BHI-FY23-178682",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T00:00:05",
          "dispatch_datetime": "2023-02-04T15:27:11",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 2,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Anchal Chaturvedi",
          "customer_phone": "074040 37354",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444252330",
          "shipping_source_code": "BLUEDART",
          "order_number": "4724866089139",
          "shipping_package_code": "SP-DEL-FY23-13204",
          "facility_code": "Delhi",
          "current_wismo_display_status": "Delivered",
          "order_datetime": "2023-02-03T09:00:05",
          "dispatch_datetime": "2023-02-03T15:56:29",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": "2023-02-07T12:06:00",
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "DEVASHISH PRASAD",
          "customer_phone": "95644 11000",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120232394",
          "shipping_source_code": "ECOM",
          "order_number": "4728276385971",
          "shipping_package_code": "SP-BHI-FY23-178814",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T21:20:04",
          "dispatch_datetime": "2023-02-06T15:02:56",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Kartikeya Munghate",
          "customer_phone": "79029 81413",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120306380",
          "shipping_source_code": "ECOM",
          "order_number": "4728988729523",
          "shipping_package_code": "SP-BHI-FY23-178835",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T09:10:04",
          "dispatch_datetime": "2023-02-06T15:03:01",
          "expected_delivered_datetime": "2023-02-13T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Birsa  Rajhans",
          "customer_phone": "7978599369",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120245626",
          "shipping_source_code": "ECOM",
          "order_number": "4726547611827",
          "shipping_package_code": "SP-DEL-FY23-13215",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T12:10:03",
          "dispatch_datetime": "2023-02-06T14:54:04",
          "expected_delivered_datetime": "2023-02-11T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "sagar sahu",
          "customer_phone": "9667228552",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120247484",
          "shipping_source_code": "ECOM",
          "order_number": "4728977653939",
          "shipping_package_code": "SP-BHI-FY23-178833",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-06T08:50:04",
          "dispatch_datetime": "2023-02-06T15:03:00",
          "expected_delivered_datetime": "2023-02-14T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Akash Singh",
          "customer_phone": "98003 69514",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3119717049",
          "shipping_source_code": "ECOM",
          "order_number": "4726670688435",
          "shipping_package_code": "SP-BHI-FY23-178713",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T15:20:05",
          "dispatch_datetime": "2023-02-05T13:40:48",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Rounak Hoque",
          "customer_phone": "8927606071",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "3120232639",
          "shipping_source_code": "ECOM",
          "order_number": "4728003002547",
          "shipping_package_code": "SP-BHI-FY23-178796",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T16:10:03",
          "dispatch_datetime": "2023-02-06T15:02:56",
          "expected_delivered_datetime": "2023-02-10T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "SHIP_TO_CUSTOMER",
          "customer_name": "Neetika Tiwari",
          "customer_phone": "76519 49538",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444252481",
          "shipping_source_code": "BLUEDART",
          "order_number": "4723959791795",
          "shipping_package_code": "SP-BHI-FY23-178597",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-02T20:20:05",
          "dispatch_datetime": "2023-02-04T15:27:15",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Balavan Vignesh",
          "customer_phone": "099413 02995",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444327311",
          "shipping_source_code": "BLUEDART",
          "order_number": "4725409317043",
          "shipping_package_code": "SP-BHI-FY23-178654",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-03T20:10:04",
          "dispatch_datetime": "2023-02-04T15:27:10",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Aadesh  Surana ",
          "customer_phone": " 70438 37986",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444404742",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726914482355",
          "shipping_package_code": "SP-BHI-FY23-178735",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T19:40:04",
          "dispatch_datetime": "2023-02-05T15:53:39",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Aaditya Malhotra",
          "customer_phone": "96505 00266",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444219452",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721970839731",
          "shipping_package_code": "SP-BHI-FY23-178534",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T13:10:05",
          "dispatch_datetime": "2023-02-03T15:27:29",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 5,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Shivam Mishra",
          "customer_phone": "7973325500",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444344236",
          "shipping_source_code": "BLUEDART",
          "order_number": "4726466216115",
          "shipping_package_code": "SP-BHI-FY23-178685",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-04T10:30:04",
          "dispatch_datetime": "2023-02-04T15:27:15",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 6,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "G Aaraadhya",
          "customer_phone": " 77806 26281",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "20443007303",
          "shipping_source_code": "BLUEDART",
          "order_number": "4727612833971",
          "shipping_package_code": "SP-DEL-FY23-13220",
          "facility_code": "Delhi",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-05T06:10:04",
          "dispatch_datetime": "2023-02-06T15:56:45",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Naren Garapati",
          "customer_phone": "75692 44875",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444031631",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721992663219",
          "shipping_package_code": "SP-BHI-FY23-178395",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T13:40:04",
          "dispatch_datetime": "2023-02-02T15:27:30",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Amant Kumar  Kumar",
          "customer_phone": "9541058024",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444143060",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721735008435",
          "shipping_package_code": "SP-BHI-FY23-178479",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T09:40:04",
          "dispatch_datetime": "2023-02-03T15:27:34",
          "expected_delivered_datetime": "2023-02-07T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 4,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Vinutha  L",
          "customer_phone": "9945041608",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444223630",
          "shipping_source_code": "BLUEDART",
          "order_number": "4723975979187",
          "shipping_package_code": "SP-BHI-FY23-178560",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-02T20:30:05",
          "dispatch_datetime": "2023-02-03T15:27:29",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "SUBHAJIT DEY",
          "customer_phone": "90737 02066",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53444167991",
          "shipping_source_code": "BLUEDART",
          "order_number": "4723609174195",
          "shipping_package_code": "SP-BHI-FY23-178509",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-02T13:20:04",
          "dispatch_datetime": "2023-02-03T15:27:36",
          "expected_delivered_datetime": "2023-02-08T18:00:00",
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Shivam raj",
          "customer_phone": "97080 92768",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53443998403",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721755062451",
          "shipping_package_code": "SP-BHI-FY23-178342",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T10:10:04",
          "dispatch_datetime": "2023-02-01T15:33:30",
          "expected_delivered_datetime": null,
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Rohit Raman",
          "customer_phone": "99626 04995",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53443989152",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721764237491",
          "shipping_package_code": "SP-BHI-FY23-178348",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T10:30:04",
          "dispatch_datetime": "2023-02-01T15:33:30",
          "expected_delivered_datetime": null,
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "Sushant More",
          "customer_phone": "8291092926",
          "tenant_code": "bajaao"
        },
        {
          "tracking_number": "53443983784",
          "shipping_source_code": "BLUEDART",
          "order_number": "4721217208499",
          "shipping_package_code": "SP-BHI-FY23-178336",
          "facility_code": "ARIHANT",
          "current_wismo_display_status": "In Transit",
          "order_datetime": "2023-02-01T00:30:03",
          "dispatch_datetime": "2023-02-01T15:33:27",
          "expected_delivered_datetime": null,
          "delivered_datetime": null,
          "no_of_items": 1,
          "payment_method": "PREPAID",
          "shipping_type": "CUSTOM",
          "customer_name": "diwakar kaushal",
          "customer_phone": "94213 81886",
          "tenant_code": "bajaao"
        }
      ])
    }).then((result)=>{
      return result;
    });
    return rows;
  }

  async function fetchShipmentList() {
    try {
      const res = await fetch(API_HOST + "/shipper/api/tracking-list", {
        method: "POST",
        headers: {
          'APP-KEY': '#$%^SK&SNLSH*^%SF'
        },
        body: JSON.stringify({ "search_text": searchQuery, "from": fromDate, "to": toDate })
      });

      if (!res.ok) throw new Error(res.statusText);

      const data = await res.json();
      setShippingList(data.result.tracking_records.map((row: any) => {
        return [
          <Box>
            <Text>AWB: {row.tracking_number}</Text>
            <Text>Courier: {row.shipping_source_code}</Text>
          </Box>,
          `${row.order_number}`,
          <Box>
            <Text>{row.customer_name}</Text>
            <Text>{row.customer_phone}</Text>
          </Box>,
          `${row.shipping_package_code}`,
          `${row.facility_code}`,
          `${row.current_wismo_display_status}`,
          <Text>{parseDate(row.order_datetime)}</Text>,
          <Text>{parseDate(row.dispatch_datetime)}</Text>,
          <Text>{parseDate(row.expected_delivered_datetime)}</Text>,
          <Text>{parseDate(row.delivered_datetime)}</Text>,
          `${row.no_of_items}`,
          `${row.tracking_number}`
        ]
      }))
    } catch (err) {
      console.log(err);
    }
  }

  useEffect(() => {
    fetchShipmentList();
  }, [])

  useEffect(() => {
    const { from, to } = resolveDuration(duration, fromDate, toDate);
    setFromDate(from);
    setToDate(to);
  }, [duration])

  const handleSearch = () => {
    if (new Date(fromDate).getTime() > new Date(toDate).getTime()) {
      toast({
        status: 'error',
        title: 'Invalid date range',
        variant: 'left-accent',
        position: 'top-right',
        duration: 4000,
        isClosable: true,
      });
      return;
    }

    fetchShipmentList();
  }

  const handleDownloadAsCSV = () => {
    const data = getDownloadableData().then(data => {
      console.log(data);
      if(!!data) {
        const csv = PapaParse.unparse(data);
        console.log(csv);
        const blob = new Blob([csv], {type: "text/csv"});
        const a = document.createElement("a");
        a.download = `${new Date().toLocaleDateString('en-IN').split('/').join("")}_${new Date().toLocaleTimeString().split(':').join("")}.csv`;
        a.href = window.URL.createObjectURL(blob)
        const clickEvt = new MouseEvent('click', {
          view: window,
          bubbles: true,
          cancelable: true,
        })
        a.dispatchEvent(clickEvt)
        a.remove()
      }
    });
  }

  return (

    <AdminLayout>

      <div className="row">
        <div className="col-md-12">
          <Card className="mb-4">
            <CardHeader bg="gray.100" py={4}>
              <Flex justifyContent="space-between" align="center">
                <Input value={searchQuery} placeholder="Search AWB/Order number/Phone number" w={`30%`} bg={`#fff`} onChange={(e) => setSearchQuery(e.target.value)} />
                <Flex gap={4}>

                  <Flex justifyContent="flex-end" align={`center`}>
                    <Text as="span" mr={2}>Timeline: </Text>
                    <Menu>
                      <MenuButton as={Button} bg={`white`} rightIcon={<AiFillCaretDown />} w="8.5rem" h={`2rem`} p={2} fontSize="sm">
                        {duration}
                      </MenuButton>
                      <MenuList>
                        {Object.keys(Duration).map((key, index) => (
                          <MenuItem key={index} onClick={() => setDuration(Duration[key as keyof typeof Duration])}>
                            {Duration[key as keyof typeof Duration]}
                          </MenuItem>
                        ))}
                      </MenuList>
                    </Menu>
                    {
                      duration === Duration.CUSTOM
                        ? (
                          <>
                            <Box ml={2}>
                              <Text as="span" mr={2}>From: </Text>
                              <Input type="date" value={fromDate} onChange={(e) => setFromDate(e.target.value)} w="10rem" background="white" />
                            </Box>
                            <Box ml={2}>
                              <Text as="span" mr={2}>To: </Text>
                              <Input type="date" value={toDate} onChange={(e) => setToDate(e.target.value)} w="10rem" background="white" />
                            </Box>
                          </>
                        )
                        : null
                    }
                  </Flex>
                  <Tooltip hasArrow label="Download as CSV">
                    <IconButton size="sm" colorScheme="teal" icon={<TbDownload />} aria-label={'download'} onClick={() => handleDownloadAsCSV()}></IconButton>
                  </Tooltip>
                  <a style={{display: "none"}} href="#" ref={csvLink}></a>
                  <Button colorScheme="teal" size="sm" onClick={handleSearch}>Search</Button>
                </Flex>
              </Flex>
            </CardHeader>
            <CardBody className="px-0 py-0" bg="white">
              <TableComponent parseDate={parseDate} shippingList={shippingList} />
            </CardBody>
          </Card>
        </div>
      </div>
    </AdminLayout>
  )
}
